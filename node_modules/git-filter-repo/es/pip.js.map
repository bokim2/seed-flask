{"version":3,"sources":["../src/pip.ts"],"names":["execa","Pip","gitPath","process","cwd","logger","console","packageName","options","user","run","args","dryrun","pipe","argsArr","Array","isArray","command","join","info","p","stdio","stdout","JSON","parse"],"mappings":";;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,OAAOA,KAAP,MAAkB,OAAlB;;IAEqBC,G;AACnB,iBAAsE;AAAA,QAAnDC,OAAmD,uEAAzCC,OAAO,CAACC,GAAR,EAAyC;AAAA,QAAlBC,MAAkB,uEAATC,OAAS;;AAAA;;AAAA,SAAnDJ,OAAmD,GAAnDA,OAAmD;AAAA,SAAlBG,MAAkB,GAAlBA,MAAkB;AAAE;;;;;8EAExE,iBAAcE,WAAd;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAmCC,gBAAAA,OAAnC,2DAAyE,EAAzE;AAAA;AAEIC,kBAAAA,IAAI,EAAE;AAFV,mBAGOD,OAHP,GACUC,IADV,iBACUA,IADV;AAKE,uBAAOD,OAAO,CAACC,IAAf;AALF,iDAMS,KAAKC,GAAL,EACJ,SADI,4BACWD,IAAI,GAAG,CAAC,QAAD,CAAH,GAAgB,EAD/B,IACoCF,WADpC,IAELC,OAFK,CANT;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;;;;;;;;;;;0EAYA,kBACEG,IADF;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAEEH,gBAAAA,OAFF,8DAEoC,EAFpC;AAAA;AAKII,kBAAAA,MAAM,EAAE,KALZ;AAMIC,kBAAAA,IAAI,EAAE,KANV;AAOIT,kBAAAA,GAAG,EAAED,OAAO,CAACC,GAAR;AAPT,mBAQOI,OARP,GAIUJ,GAJV,yBAIUA,GAJV,EAIeS,IAJf,yBAIeA,IAJf,EAIqBD,MAJrB,yBAIqBA,MAJrB;AAUQE,gBAAAA,OAVR,sBAUuBC,KAAK,CAACC,OAAN,CAAcL,IAAd,IAAsBA,IAAtB,GAA6B,CAACA,IAAD,CAVpD;AAWQM,gBAAAA,OAXR,iBAWyBH,OAAO,CAACI,IAAR,CAAa,GAAb,CAXzB;;AAAA,qBAYMN,MAZN;AAAA;AAAA;AAAA;;AAaI,qBAAKP,MAAL,CAAYc,IAAZ,CAAiBF,OAAjB;AAbJ,kDAcWA,OAdX;;AAAA;AAgBQG,gBAAAA,CAhBR,GAgBYpB,KAAK,CAAC,IAAD,EAAO,CAAC,IAAD,EAAOiB,OAAP,CAAP,EAAwB;AAAEI,kBAAAA,KAAK,EAAE,MAAT;AAAiBjB,kBAAAA,GAAG,EAAHA;AAAjB,iBAAxB,CAhBjB;AAiBE,oBAAIS,IAAJ,EAAU,aAAAO,CAAC,CAACE,MAAF,wDAAUT,IAAV,CAAeV,OAAO,CAACmB,MAAvB;AAjBZ;AAAA,uBAkB2BF,CAlB3B;;AAAA;AAAA;AAkBUE,gBAAAA,MAlBV,YAkBUA,MAlBV;AAAA;AAAA,kDAoBWC,IAAI,CAACC,KAAL,CAAWF,MAAX,CApBX;;AAAA;AAAA;AAAA;AAAA,kDAsBWA,MAtBX;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;;;;;;;;;;;;;SAfmBrB,G","sourcesContent":["/**\n * Copyright 2021 Silicon Hills LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport execa from 'execa';\n\nexport default class Pip {\n  constructor(public gitPath = process.cwd(), private logger = console) {}\n\n  async install(packageName: string, options: Partial<PipInstallOptions> = {}) {\n    const { user } = {\n      user: true,\n      ...options\n    };\n    delete options.user;\n    return this.run(\n      ['install', ...(user ? ['--user'] : []), packageName],\n      options\n    );\n  }\n\n  async run(\n    args: string | string[],\n    options: Partial<PipRunOptions> = {}\n  ): Promise<any> {\n    const { cwd, pipe, dryrun } = {\n      dryrun: false,\n      pipe: false,\n      cwd: process.cwd(),\n      ...options\n    };\n    const argsArr = [...(Array.isArray(args) ? args : [args])];\n    const command = `pip ${argsArr.join(' ')}`;\n    if (dryrun) {\n      this.logger.info(command);\n      return command;\n    }\n    const p = execa('sh', ['-c', command], { stdio: 'pipe', cwd });\n    if (pipe) p.stdout?.pipe(process.stdout);\n    const { stdout } = await p;\n    try {\n      return JSON.parse(stdout);\n    } catch (err) {\n      return stdout;\n    }\n  }\n}\n\nexport interface PipRunOptions {\n  cwd?: string;\n  dryrun?: boolean;\n  pipe?: boolean;\n}\n\nexport interface PipInstallOptions extends PipRunOptions {\n  user?: boolean;\n}\n"],"file":"pip.js"}